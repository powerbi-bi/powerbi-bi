### 背景

学谦数据集团下设多个部门，其中财务部和运营部的小伙伴先后独立购买了全球版的Power BI pro账号10个和15个各自开发报告（都怪学谦疏于管理）。由于是分开独立购买，因此域名自然是不同的，即分属两个不同的组织。

财务部报表开发得差不多了的时候，为我提供了一个账号，这样我就可以随时查看当前的各项指标数据并监督查看他们的开发进度。

后来，运营部的小伙伴，也给我提供了一个账号。

那么，我就有2个不同组织下的账号。问题就来了，我要登录财务部账号，就得退出运营部账号，反之亦然。或者我需要两个浏览器，分别登录这两个账号。

![image-20220722170341156](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722170341156.png)

很明显，这，不太方便。

### 讨论思考

首先，两个不同的组织之间想要共享报告是不可能的。

而且同一个账号也不可能同时位于两个组织，工作区也无法邀请组织外的人进入。

既然云端service走不通，那么只能想办法从本地的pbix文件上突破了。

办法倒是有，运营部可以将pbix文件直接发给我，我在本地电脑上打开刷新浏览。但是这样问题很多：第一，我开会时或者出差带着我的MacBook，没有装虚拟机，无法打开pbix文件；第二，他们最近开发比较频繁，不可能每一个版本都给我发文件，而且发文件整体的发送保存比较麻烦不说，通过qq微信安全性也不好……

忽然想起来，我们不仅购买了Power BI pro，还同时购买了全套的office365商业版，有Onedrive for Business，这样通过ODB或者SharePoint就可以同步过来文件，而且他们平时也都是使用ODB进行版本更迭与控制。但是仍然解决不了我的电脑无法安装Power BI desktop的问题。

所以，本地的pbix分享所有的方式，其实都不满足我的要求。还是得在云端报告上找方法。

等等，Onedrive for Business，Power BI可以直接从里面读pbix文件啊！

但是有一个前提，Power BI只能从同一个账号下的ODB或同一个组织下的SharePoint中读取pbix文件。

我们梳理一下手头的东西：

财务部Power BI和ODB账号，运营部Power BI和ODB账号，运营部ODB中的pbix文件。

不难发现如下的解决方案：

只要让运营部ODB中的pbix文件出现在财务部的ODB中，这样财务部的Power BI就可以获取这个pbix文件，显示在财务部的Power BI云端工作区当中。

那么问题的关键就在于：

如何让运营部ODB中的pbix文件出现在财务部的ODB中？

或者换个说法：

如何让运营部ODB中的pbix文件能够随时同步到财务部的ODB中呢？

![image-20220722170513475](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722170513475.png)

### 解决方案

想必大家已经猜到了， 或者说从本文的标题上也找到了答案：

Power Automate

![image-20220722170819269](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722170819269.png)

我们可以使用云端自动化流，当运营部ODB中的pbix文件发生修改时，将该文件复制到财务部的ODB中，覆盖原有的文件以达到更新的目的。

![image-20220722172112120](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722172112120.png)

下图是运营部的ODB中的文件：

![image-20220722172209498](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722172209498.png)

flow运行成功后，在财务部的ODB中出现了同样的文件，并且每次文件更新时，财务部ODB中的文件会直接覆盖更新：

![image-20220722172321949](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722172321949.png)

而且进行多次更新后，我们可以在财务部ODB的文件上选择查看版本，并且随时进行版本控制。

同时也说明了一个事实：在ODB中进行同名文件覆盖操作，同样会保留原来文件的版本，这一点非常重要。因为在本地计算机上进行文件的覆盖操作，你是无法找回原来文件的。

![image-20220722172711826](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722172711826.png)



这样，我们在财务部的Power BI service上创建一个工作区，命名为“运营部”，将财务部ODB中的“运营部2022.pbix”文件添加到工作区，就可以实现在登录同一个账号的提前下，查看两个不同组织发布的报告了。
![image-20220722173428168](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722173428168.png)



而且由于是从ODB中获取的pbix文件，同样会享受到自动的每小时模型更新。

![image-20220722173806580](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722173806580.png)

下图为整个的流程：

![image-20220722174206856](https://picgo-1301351990.cos.ap-beijing.myqcloud.com/markdown/image-20220722174206856.png)





#### 总结

本文所述案例，是真实发生在国内某企业的，由于缺乏整体宏观管理，导致同一公司的两个部门之间同时使用Power BI但却不在同一个组织内，让两个部门之间的报表和数据出现不可跨越的壁垒。

本文使用Power Automate云端流解决了这一问题。为已经发生此类相似事情的企业提供方法借鉴，同时也对可能会发生此类事件的企业做出一个警示。

同时，也建议公司还是对对账号进行统一管理，统一域名，方便进行同一组织下的数据分享。

对于该方法，发挥一下想象，拓展一下想必还可以发挥更多更有趣也更有用的作用。

我是学谦，专注于企业数字化生产力提升与完善。

